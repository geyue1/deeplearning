# -* UTF-8 *-
'''
==============================================================
@Project -> File : pytorch -> accuracy_.py
@Author : yge
@Date : 2023/4/1 18:09
@Desc :

==============================================================
'''
import torch

output = torch.tensor([
    [1,2,3],
    [3,4,1],
    [9,2,3]
])
device = torch.device("mps")
device_cpu = torch.device("cpu")
target = torch.tensor([2,3,0])
target = target.to(device)
# predicte = output.argmax(1)
print(f"target={target}")
output = output.to(device)
print(output.argmax(1))
# predicte = output.argmax(1)
# print(f"predicte={predicte }")
# printnt(predicte==target)

print(output.argmax(1)==target)
print((output.argmax(1)==target).sum())


output2 = torch.tensor([[ 2.2229e+01, -1.6529e-01, -1.9242e+00,  1.0919e+00, -4.3146e+00,
         -7.2968e+00, -8.7123e+00,  1.7743e+00,  1.4939e+01,  3.1149e+00],
        [ 1.7952e+01, -1.3804e+01,  4.8300e+00,  4.3754e+00,  1.1844e+01,
         -1.7446e+00, -1.3118e+01,  8.3554e+00,  3.7411e+00, -8.4911e+00],
        [-5.0913e-01, -6.0074e+00,  1.1077e+01,  2.5075e+00,  3.6647e+00,
          5.8525e+00, -1.5425e+00,  2.3221e+00, -8.5128e+00, -6.2269e+00],
        [ 5.9633e-01, -3.5128e+00,  3.0865e+00,  3.7320e+00, -1.9242e+00,
         -2.0310e+00,  9.8518e+00, -2.1316e+00,  6.4506e+00, -6.2923e+00],
        [-6.4418e+00, -7.6784e+00,  5.1389e+00,  1.0561e+00,  4.8774e+00,
         -1.0986e+00,  4.6312e+00,  1.0943e+00,  1.3423e+00, -4.5875e+00],
        [-1.4638e-01, -6.3431e+00,  3.6355e+00,  1.3962e+00,  7.0787e+00,
         -8.5919e-01,  3.1810e-01, -1.5686e+00, -2.6502e+00, -4.3828e+00],
        [ 6.3623e+00, -6.2823e-01,  2.0690e+00,  1.9842e+00, -4.5991e+00,
         -5.5768e+00,  4.4279e+00, -5.7558e+00,  1.0857e+01, -8.5085e-01],
        [-4.9257e+00,  9.2928e+00, -5.9074e+00,  8.2165e-01, -1.3980e+01,
         -2.0986e+00, -1.2156e+01, -8.6679e+00, -1.5795e+00,  2.3871e+01],
        [ 8.5192e+00,  2.5680e+00, -1.1514e+00, -1.4362e+00, -4.1824e+00,
         -9.1211e+00, -9.7869e-01,  7.2586e-01,  5.2926e+00,  8.2352e+00],
        [-1.6671e+00, -6.6627e+00,  4.0915e+00,  5.5674e+00,  5.1666e+00,
          2.1851e+00,  3.0740e+00, -5.4853e+00,  8.8365e-01, -9.3621e+00],
        [-1.7489e+00, -9.7945e+00,  7.6380e+00,  1.2580e+00,  9.4175e+00,
         -9.0284e-01, -2.9946e+00,  2.4913e+00, -2.0030e+00, -8.4326e+00],
        [ 1.1319e+01, -4.8202e+00,  8.5738e+00, -2.1698e-01,  2.6581e+00,
         -5.0295e+00, -6.7927e+00, -4.2073e+00,  6.6477e+00, -5.1818e+00],
        [ 3.8361e+00, -3.5242e-01,  1.4064e+01,  2.1319e+00, -5.9314e-02,
          4.0338e+00, -4.6967e+00, -1.3082e+00, -5.0093e+00, -9.4710e+00],
        [ 4.4755e+00, -1.0712e+01, -3.9669e+00,  3.7102e+00,  9.0741e+00,
          2.7760e+00,  1.1277e+00,  1.2477e+01, -8.9073e-01, -6.5437e+00],
        [ 3.3991e+00, -1.7116e+00,  6.2485e+00,  1.6107e+00, -5.8255e-01,
         -4.4052e+00,  1.1667e+01,  1.6511e-01, -1.9769e+00, -5.2066e+00],
        [ 1.5276e+00,  1.6053e+01, -2.9726e+00, -1.3144e+00, -3.5187e+00,
         -2.4195e+00, -4.1535e+00, -3.1545e+00, -4.3052e+00,  3.0598e+00],
        [ 9.6362e+00,  4.0595e+00, -1.4462e-01, -5.8322e+00, -3.3914e+00,
         -8.0224e+00, -6.5296e+00, -6.9003e+00,  1.1524e+01,  6.6868e+00],
        [ 1.9796e-01, -3.6386e+00,  6.8188e+00, -2.0435e-01,  3.5924e+00,
          2.3213e+00,  1.3333e+00, -6.5491e+00, -3.6505e+00, -6.3937e+00],
        [ 2.1859e+00, -3.5991e-02, -7.6230e+00,  1.4738e+00, -1.4940e+01,
          5.7227e+00,  5.2664e-01, -1.9202e+00,  4.3913e+00,  1.7883e+01],
        [-9.6136e+00,  7.9774e+00,  1.2632e+00,  6.1947e+00, -2.5499e+00,
          3.2492e+00, -1.7696e-01, -6.8897e+00, -3.3884e+00, -4.4412e+00],
        [-6.0508e+00, -9.2735e+00,  8.6633e-01,  7.8787e+00,  3.6791e+00,
          8.3535e+00,  5.5142e+00,  1.2019e+01, -1.3270e+01, -2.6517e+00],
        [ 1.3616e+01,  6.1523e+00,  6.2820e-01, -2.4299e+00, -1.0517e+00,
         -8.6228e+00, -8.9789e-01,  2.8266e-01,  8.2091e+00, -4.5971e+00],
        [ 3.0396e+00, -1.2651e+00,  4.3210e+00,  6.8500e+00, -1.1787e+01,
          5.5656e+00,  1.2820e+01, -4.9353e+00,  2.6492e+00, -6.8170e+00],
        [ 4.5096e+00, -4.2517e+00,  1.1220e+01,  3.3319e+00,  3.1356e+00,
         -6.2816e+00,  1.4954e+00,  1.6415e+00, -3.3545e+00, -4.4827e+00],
        [ 1.3226e+01, -4.5764e-01,  3.6892e+00, -4.3385e+00,  2.4866e+00,
         -1.3755e+00, -1.1083e+01,  4.8605e-01,  1.7185e+00,  3.1557e+00],
        [ 8.5161e-01, -6.6430e+00,  7.4393e+00, -2.1034e-01,  5.8241e+00,
          7.1141e-01,  1.1999e+00,  2.6852e+00, -3.2509e+00, -7.2644e+00],
        [-1.4780e+00,  6.2649e-01,  3.4639e+00,  1.8193e+00, -1.6923e+00,
          4.5178e+00, -6.4696e+00, -4.7877e+00, -5.5668e+00,  4.4001e+00],
        [ 9.1981e-01, -5.5379e+00,  5.0523e+00, -2.8575e-01,  1.0608e+01,
         -2.5192e+00, -5.7907e+00,  4.7463e+00, -5.5641e-01, -7.4673e+00],
        [-3.4372e+00,  6.4003e+00, -3.2124e+00,  6.6082e+00, -8.0887e+00,
         -6.1967e-01, -4.1148e+00, -1.1921e+01,  6.0516e+00,  4.7451e+00],
        [ 1.4148e+01,  2.6794e+00, -7.1541e+00, -4.3333e+00, -6.4026e+00,
         -1.3402e+01, -9.2033e+00, -9.1351e+00,  2.6766e+01,  1.0918e+01],
        [-8.5233e+00, -6.2046e+00,  7.4085e-01,  2.4274e+00,  7.1490e+00,
          1.7038e+00,  8.7998e+00,  2.8416e+00, -8.0412e+00, -5.6665e+00],
        [-3.1112e+00, -1.1686e+01,  3.2922e+00,  4.3557e+00,  5.0871e+00,
          7.3365e+00, -3.0170e+00,  6.3411e+00, -2.5076e+00, -2.6665e+00],
        [ 7.0430e+00, -4.3963e+00,  2.9855e+00,  1.0644e+00,  1.2548e+01,
         -9.0148e+00, -2.8699e+00,  2.1947e+00,  1.3012e+00, -6.8412e+00],
        [-7.6677e-01,  1.4178e-01, -4.8516e+00,  3.3072e+00,  2.6311e+00,
         -2.0092e+00, -8.5137e-01,  1.3422e+01, -1.4406e+00,  1.6823e-01],
        [-1.6701e-01,  6.2696e+00,  1.6922e-01,  1.2736e+00, -1.5528e+01,
          5.7089e+00,  2.4986e+00, -8.0660e+00,  1.1222e+00,  1.1733e+01],
        [-6.5563e+00, -5.3865e+00,  4.6318e-01,  5.9356e+00,  2.7701e+00,
          2.0383e+00,  1.0689e+01,  1.0690e-01, -2.3273e+00, -7.9574e+00],
        [-2.1609e+00,  9.7974e-01,  3.2956e-01,  1.8676e+00, -8.6104e+00,
         -8.3842e-01,  1.8880e+00, -1.2320e+01,  1.8702e+01, -1.3928e+00],
        [-1.6583e+00,  2.4222e+00,  1.7728e+00,  8.8159e+00, -1.1956e+00,
          2.5457e+00,  1.1906e+01,  5.9781e-01, -1.0910e+01, -6.7889e+00],
        [ 1.1274e+01,  9.1971e+00, -4.3213e+00, -4.6921e+00,  7.2327e-01,
         -1.2382e+01, -3.5948e+00, -8.4000e+00,  1.6896e+01, -3.7725e-01],
        [ 7.6401e+00,  4.5263e+00, -4.2559e+00, -8.9530e-01, -2.7159e+00,
         -6.8105e+00, -5.7162e+00, -9.0208e+00,  5.7171e+00,  6.2600e+00],
        [ 2.7688e+00, -1.0956e+01,  9.5228e+00, -1.7578e+00,  7.3136e+00,
          4.9567e-01, -5.7493e+00,  1.7946e+01, -9.9332e-01, -8.0243e+00],
        [ 9.2549e+00,  9.4641e+00,  5.9856e+00, -1.3315e+00, -9.1678e+00,
         -4.4116e+00,  8.7034e-02, -9.1755e+00,  1.1723e+01, -8.9686e-01],
        [-9.1065e+00, -8.2883e-01,  2.4816e+00,  8.2183e+00, -9.2495e+00,
          7.2364e+00,  2.6244e+00, -3.6327e+00,  2.9642e+00, -3.6268e+00],
        [ 1.5121e+01,  3.9335e+00,  3.0949e+00, -2.3707e+00, -2.2109e+00,
         -6.0213e+00, -7.5440e+00, -1.0049e+01,  6.0770e+00,  1.4023e+00],
        [ 3.1290e+00, -3.0237e+00,  3.5780e+00,  2.4028e+00,  4.4283e+00,
          9.2329e-01,  1.6648e+00,  5.5215e+00, -2.7939e+00, -7.0958e+00],
        [-7.8531e-02,  5.0848e+00, -4.0038e+00,  5.1702e+00, -6.0730e+00,
          6.1252e+00,  1.0044e+00,  4.5479e+00, -5.2760e+00,  3.7267e+00],
        [-7.1560e+00,  1.9026e+01, -2.0300e+01,  9.0872e-01, -1.2052e+01,
         -3.6339e+00,  4.1070e+00, -1.1945e+00, -6.1918e+00,  1.8462e+01],
        [ 1.3227e+01,  5.1922e+00, -4.3955e+00,  5.0816e+00, -1.0372e+01,
          1.7492e+00, -4.6922e+00, -3.3087e+00,  3.1741e+00,  6.0752e+00],
        [-6.0528e+00, -1.9227e+00, -3.2682e+00,  1.0133e+01, -8.1141e+00,
          1.1684e+01,  6.8985e+00, -2.0215e+00, -4.1447e-01, -5.1637e-01],
        [ 9.5581e+00,  1.9888e+01, -1.7011e+01,  2.7383e+00, -1.7684e+01,
         -1.2629e+01,  2.4382e+00, -1.7307e+01,  2.0097e+01,  1.3996e+01],
        [ 1.6034e+01,  1.2597e+01, -6.0214e+00,  3.5945e+00, -1.3111e+01,
         -5.2896e+00,  2.5679e+00, -4.2235e+00,  4.1705e+00,  8.1196e+00],
        [-7.8485e+00,  4.2210e+00,  1.5395e+00,  3.0191e+00, -5.6602e-01,
         -1.9553e+00,  1.5303e+01, -5.4606e+00, -5.8741e+00, -7.6870e+00],
        [ 5.5211e-01, -1.9638e+00,  1.9244e+00,  5.5945e+00, -4.4964e+00,
          6.6972e+00,  1.8070e+00, -3.4617e+00, -3.8393e+00, -5.5800e-01],
        [ 3.7502e+00,  1.9037e+00, -1.8814e+00,  2.6456e+00, -1.0538e+00,
          1.0520e+01, -8.3597e+00,  1.1836e+01, -7.4471e+00,  1.7882e+00],
        [-3.4046e-01,  7.3861e+00, -5.5409e+00,  1.2210e+00, -1.5565e+00,
         -6.4841e+00, -1.1207e+00,  7.8740e-01, -3.2627e+00,  8.3199e+00],
        [-9.8161e-01, -1.4325e+01,  1.1027e+01,  2.3562e+00,  9.6195e+00,
          1.2404e-01, -7.4914e-01,  6.3014e+00, -5.6182e+00, -3.5518e+00],
        [-1.2016e+00, -5.8406e+00,  9.5665e-01, -3.0703e-01,  2.2618e+00,
          2.9451e+00, -2.5849e+00,  2.5799e+00, -1.8171e+00,  5.2803e-01],
        [ 7.4160e+00, -3.7788e+00, -3.0511e+00, -8.3468e-01,  6.8822e-01,
         -4.6744e+00, -1.8650e+00, -5.3487e+00,  1.0866e+01,  1.0287e+00],
        [-4.1240e+00, -1.2795e+00, -1.8253e+00,  8.3168e+00,  8.3703e+00,
          5.2998e-01, -8.9683e+00,  9.9034e+00, -8.1763e+00, -4.0417e+00],
        [ 6.7695e+00, -5.8971e+00,  2.1373e+00,  4.0994e+00, -2.4634e+00,
          3.5685e+00,  5.6505e+00, -2.5868e-04, -3.2098e+00, -2.8177e-01],
        [ 5.8580e+00,  1.4993e+01, -4.1616e+00, -1.6927e+00, -7.6462e+00,
         -7.6324e+00, -3.8590e+00, -2.5121e+00,  5.2312e+00,  7.5826e+00],
        [-1.3794e+00,  1.9621e+01, -2.4036e+01,  2.2636e+00, -4.9809e+00,
         -5.0769e+00, -1.0953e+00, -1.2873e+01, -6.6900e+00,  1.5557e+01],
        [-1.0555e+01, -2.0584e+00,  5.3573e+00,  4.2992e+00,  4.3308e+00,
          1.6555e+00,  1.0333e+01, -5.0733e-01, -1.0905e+01, -8.7376e+00],
        [ 1.6514e+01,  2.2528e+00, -4.3969e+00,  4.3117e-01,  1.3025e+00,
         -7.8592e+00, -8.0519e+00, -6.3107e+00,  6.7077e+00,  2.7143e+00]]
       ,device='mps:0')
device = torch.device("mps")
device_cpu = torch.device("cpu")
output2 = output2.to(device_cpu)
print(f"output2.argmax(1):{output2.argmax(1)}")
print(f"output2.argmax(1):{torch.argmax(output2,dim=1)}")
print("*************************************************")
accuracy = 5043.0/10000
print(accuracy)
